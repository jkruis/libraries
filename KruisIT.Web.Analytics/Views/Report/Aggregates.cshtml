@model KruisIT.Web.Analytics.Models.CurrentList<KruisIT.Web.Analytics.Models.Aggregate>
@{
	Layout = null;

	int maxCount = Model.Data.Any() ? Model.Data.Max(m => m.Count) : 0;
	int dayCount = Model.Data.Count;
}

<div class="analytics-aggregates analytics-aggregates-rotated">
	<h4>Aggregates</h4>

	<table>
		<thead>
			<tr>
				<th>@Html.DisplayNameFor(model => model.Data.FirstOrDefault().Date)</th>
				<th>@Html.DisplayNameFor(model => model.Data.FirstOrDefault().Count)</th>
			</tr>
		</thead>
		<tbody>
			@for (int dayIndex = 0; dayIndex < Model.Data.Count; dayIndex++)
			{
				var agg = Model.Data[dayIndex];
				var width = 100 * agg.Count / maxCount;
				<tr>
					<td class="analytics-date">
						@if (0 == dayIndex || (dayIndex == (dayCount / 4)) || (dayIndex == (dayCount / 2)) || (dayIndex == (dayCount * 3 / 4)) || dayCount - 1 == dayIndex)
						{ 
							<text>@agg.Date.ToString("yyyy-MM-dd")</text>
						}
					</td>
					<td class="analytics-count"><div style="width: @(width)%" title="@agg.Date.ToString("yyyy-MM-dd") : @agg.Count"><span>@agg.Count</span></div></td>
				</tr>
			}
		</tbody>
	</table>
</div>
